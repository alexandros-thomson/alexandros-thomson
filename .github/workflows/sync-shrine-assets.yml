name: Sync Shrine Assets

on:
  schedule:
    - cron: "*/30 * * * *" # every 30 minutes
  workflow_dispatch:
  repository_dispatch:
    types: [update-shrine-assets]

jobs:
  sync:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Profile Repo
        uses: actions/checkout@v4
        with:
          persist-credentials: false

      - name: Pull Latest Badge
        run: |
          mkdir -p public
          curl -sL https://raw.githubusercontent.com/YOUR_ORG/sponsor-ipn-discord/main/public/latest-badge.svg \
            -o public/latest-badge.svg

      - name: Pull Latest Pulse
        run: |
          curl -sL https://raw.githubusercontent.com/YOUR_ORG/shrine-watcher/main/public/latest-pulse.svg \
            -o public/latest-pulse.svg

      - name: Commit and Push if Changed
        run: |
          git config user.name "Shrine Sync Bot"
          git config user.email "bot@users.noreply.github.com"
          git add public/latest-badge.svg public/latest-pulse.svg
          git diff --quiet && echo "No changes" || (git commit -m "ðŸ”„ Shrine assets updated" && git push)
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
